<?php 
$title = 'Your contact details';
$this->layout('layout::standard',
[
    'title' => $title,
    'pageTitle' => (!empty($form->getMessages())) ? "Error: {$title}" : null,
]);

$this->addErrorMap([
    'contact-options' => [
        'required' => [
            'summary'   => 'You must choose a way to be contacted',
            'field'     => 'Choose how we contact you'
        ]
    ],
    'email' => [
        'required' => [
            'summary'   => 'You haven\'t given your email address',
            'field'     => 'Enter your email address'
        ],
        'email-invalid' => [
            'summary'   => 'Check your email address',
            'field'     => 'Enter a valid email address'
        ],
        // If the hostname was invalid, so was the email address.
        // Thus there's no need to output the hostname validation
        'hostname-invalid' => [
            'summary'   => '',
            'field'     => ''
        ],
    ],
    'phone' => [
        'required' => [
            'summary'   => 'You haven\'t given your phone number',
            'field'     => 'Enter your phone number'
        ],
        'phone-invalid' => [
            'summary'   => 'Check your phone number',
            'field'     => 'Enter a valid phone number'
        ]
    ],
    'address' => [
        'required' => [
            'summary'   => 'You haven\'t entered a postal address',
            'field'     => 'Enter the postal address'
        ],
        'too-long' => [
            'summary'   => 'Postal address is too long',
            'field'     => 'Enter a valid postal address'
        ],
    ],
]);
?>

<?php $this->start('error-summary') ?>
    <?php $this->insert('snippet::error-summary', [ 'form'=>$form ]) ?>
    <?php $this->insert('snippet::error-summary', [ 'form'=>$adForm ]) ?>
<?php $this->stop() ?>

<p>We will use these details to:</p>

<ul class="list list-bullet">
    <li>send you email or text message updates about the refund</li>
    <li>contact you if we need more information</li> 
</ul>

<form action="" method="post" class="form">

    <?php $this->insert('snippet::form-csrf', [ 'form'=>$form ]) ?>
    
    <?php $this->insert('snippet::input-checkboxes', [
        'formElement' => $form->get('contact-options'),
        'question' => 'What contact details can you give?',
        'options' => [
            'email' => [
                'optionLabel' => "Email",
                'dataTargetMarkup' => $this->fetch('snippet::input-text', [
                    'formElement' => $form->get('email'),
                    'formLabel' => 'Email address',
                    'formType' => 'email',
                    'formLabelBold' => true,
                    'additionFormControlClass' => 'form-control-3-4'
                ])
            ],
            'phone' => [
                'optionLabel' => "Mobile number",
                'dataTargetMarkup' => $this->fetch('snippet::input-text', [
                    'formElement' => $form->get('phone'),
                    'formLabel' => 'Phone number',
                    'formType' => 'tel',
                    'formLabelBold' => true
                ])
            ]
        ],
    ])
    ?>

    <div class="form-group">
        <input type="submit" class="button" value="Continue">
    </div>

</form>

<?php if (!(empty($ad) && !is_null($adForm))): ?>

    <h2 class="heading-medium">Can't supply email or phone number?</h2>

    <form action="" method="post" class="form">

        <?php $this->insert('snippet::form-csrf', [ 'form'=>$adForm ]) ?>

        <?php
            $this->insert('snippet::input-textarea', [
                'formElement' => $adForm->get('address'),
                'formLabel' => 'Postal address',
                'formType' => 'text',
                'formLabelBold' => false,
                'additionFormControlClass' => 'form-control-3-4'
            ]);
        ?>

        <div class="form-group">
            <input type="submit" class="button" value="Continue">
        </div>

    </form>
<?php endif ?>

