<?php

$elementId = "id-{$formElement->getName()}";

// Does the element have any validation errors
$hasErrors = !empty($formElement->getMessages());

// Can there be multiple values
$multiple = ( $formElement instanceof \Zend\Form\Element\MultiCheckbox );

// Currently checked values
$vales = $formElement->getValue() ?? array();

?>

<div class="form-group<?= ($hasErrors)?' form-group-error':'' ?>">

    <fieldset>

        <legend class="visually-hidden"><?= $this->e($question) ?></legend>

        <?php foreach($formElement->getMessages() as $message): ?>
            <p class="error-message"><?= $this->e($message) ?></p>
        <?php endforeach ?>

        <?php foreach($options as $name => $option): ?>

            <div class="multiple-choice">

                <input id="<?= "{$elementId}-{$name}" ?>"
                       type="checkbox"
                       name="<?= $this->e($formElement->getName()) ?><?= ($multiple)?'[]':'' ?>"
                       value="<?= $this->e($formElement->getValueOptions()[$name]) ?>"<?= in_array($formElement->getValueOptions()[$name], $vales)?' checked':'' ?>>

                <label class="form-label" for="<?= "{$elementId}-{$name}" ?>">

                    <?= $option['optionLabel'] ?>

                </label>

            </div>

        <?php endforeach ?>

    </fieldset>

</div>
